<!doctype html>

<body>
	<canvas id="gameCanvas" width="400" height="600"></canvas>
</body>
<script src="ship.js"></script>
<script>
	var canvas, cavnasContext;

	window.onload = function() {
		canvas = document.getElementById('gameCanvas');
		canvasContext = canvas.getContext('2d');
        
        document.addEventListener('keydown',keyPressed);
        document.addEventListener('keyup',keyReleased);

		setInterval(mainloop, 1000 / 50);
	}
    
    var shipXpos = 0;
    var shipYpos = 0;
    var shipXspeed = 7;
    var shipYspeed = 7;
    var shipColor = 'white';
    const SHIP_WIDTH = 60;
    const SHIP_HEIGHT = 70;
    
    const LEFT_KEY = 65;
	const RIGHT_KEY = 68;
	const UP_KEY = 87;
	const DOWN_KEY = 83;
    
    var leftKeyPressed = false;
    var rightKeyPressed = false;
    var upKeyPressed = false;
    var downKeyPressed = false;
    
    var enemies = [];
    var enemyTotal = 8;
    var setUp = true;
    
    
    var playerImg = new Image();
    playerImg.src = 'images/ship.png';
    
    var player = new Ship(playerImg,shipXpos,shipYpos,SHIP_WIDTH,SHIP_HEIGHT,shipColor,shipXspeed,shipYspeed);

	function mainloop() {
		colorRect(0, 0, canvas.width, canvas.height, 'black'); // background
        
        if(setUp){
            settingUp();
            setUp = false;
        }
        
        if(enemies.length > 0){
            enemies.forEach(function(enemy,index){
                enemy.drawEnemy();
                enemy.enemyMove();
            });
        }
        
        player.drawShipImg();
        player.shipMovement();
        

	}
    
    function keyPressed(evt){
        if(evt.keyCode == LEFT_KEY){
           leftKeyPressed = true;
        }
        if(evt.keyCode == RIGHT_KEY){
           rightKeyPressed = true;
        }
        if(evt.keyCode == UP_KEY){
           upKeyPressed = true;
        }
        if(evt.keyCode == DOWN_KEY){
           downKeyPressed = true;
        }
    }
    
       function keyReleased(evt){
        if(evt.keyCode == LEFT_KEY){
           leftKeyPressed = false;
        }
        if(evt.keyCode == RIGHT_KEY){
           rightKeyPressed = false;
        }
        if(evt.keyCode == UP_KEY){
           upKeyPressed = false;
        }
        if(evt.keyCode == DOWN_KEY){
           downKeyPressed = false;
        }
    }
    

	function colorRect(x, y, w, h, c) {
		canvasContext.fillStyle = c;
		canvasContext.fillRect(x, y, w, h);
	}
    
    
    function settingUp(){
        for(i=0; i< enemyTotal; i++){
            makeEnemy();
        }
        shipXpos = canvas.width / 2 - SHIP_WIDTH / 2;
        shipYpos = canvas.height - SHIP_HEIGHT;
    }
    
     function makeEnemy(){
		var eWidth = Math.floor(Math.random() * (30 - 10) + 10); //(max - min) + min 
		var eHeight = Math.floor(Math.random() * (30 - 10) + 10); //(max - min) + min 
		var eXpos = Math.floor(Math.random() * ((canvas.width - eWidth) - 0) + 0);
		var eYpos = 0;
		var eXspeed = Math.floor(Math.random() * (7 - 3) + 3);
		var eYspeed = Math.floor(Math.random() * (7 - 3) + 3);
        var ecolor = 'yellow';
        
        var e = new Enemy(eXpos,eYpos,eWidth,eHeight,ecolor,eXspeed,eYspeed);
        enemies.push(e);
	}
    
     class Enemy{
        constructor(x,y,w,h,c,xSpeed,ySpeed){
            this.x = x;
            this.y = y;
            this.w = w;
            this.h = h;
            this.c = c;
            this.ySpeed = ySpeed;
            this.xSpeed = xSpeed;
        }
        
        drawEnemy(){
            canvasContext.fillStyle = this.c;
            canvasContext.fillRect(this.x, this.y, this.w, this.h)
        }
        
        enemyMove(){
            this.y += this.ySpeed;
            this.x += this.xSpeed;
            if(this.x > canvas.width - this.w || this.x < 0){
                this.xSpeed *= -1;
            }
            
            if(this.y > canvas.height){
                this.y = 0 - this.h;
            }
        }
     }
        
    
</script>
